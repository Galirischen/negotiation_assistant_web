# NegotiaPro AI Webç‰ˆ - å®Œæ•´å®‰è£…æŒ‡å—

> ä»é›¶å¼€å§‹éƒ¨ç½²Webç‰ˆè°ˆåˆ¤åŠ©æ‰‹ | é¢„è®¡æ—¶é—´: 10åˆ†é’Ÿ

---

## ğŸ“‹ å‰ç½®è¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š

### å¿…éœ€
- âœ… **Node.js** >= 18.0 ([ä¸‹è½½åœ°å€](https://nodejs.org/))
- âœ… **Python** >= 3.10 ([ä¸‹è½½åœ°å€](https://www.python.org/))
- âœ… **npm** æˆ– **yarn** (Node.jsè‡ªå¸¦npm)

### å¯é€‰
- ğŸ³ **Docker** + **Docker Compose** (ç”¨äºå®¹å™¨åŒ–éƒ¨ç½²)

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨ (å¼€å‘æ¨¡å¼)

### Step 1: å…‹éš†é¡¹ç›®

```bash
cd /Users/chenyujie
# é¡¹ç›®å·²åœ¨ negotiation_assistant_web/ ç›®å½•
```

---

### Step 2: å¯åŠ¨åç«¯

```bash
# è¿›å…¥åç«¯ç›®å½•
cd negotiation_assistant_web/backend

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨FastAPIæœåŠ¡å™¨
python main.py
```

âœ… **åç«¯å¯åŠ¨æˆåŠŸ**: æµè§ˆå™¨è®¿é—® [http://localhost:8000/docs](http://localhost:8000/docs) æŸ¥çœ‹APIæ–‡æ¡£

**é¢„æœŸè¾“å‡º**:
```
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

---

### Step 3: å¯åŠ¨å‰ç«¯

**æ‰“å¼€æ–°ç»ˆç«¯çª—å£**ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd negotiation_assistant_web/frontend

# å®‰è£…Node.jsä¾èµ–
npm install

# å¯åŠ¨Viteå¼€å‘æœåŠ¡å™¨
npm run dev
```

âœ… **å‰ç«¯å¯åŠ¨æˆåŠŸ**: æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€ [http://localhost:5173](http://localhost:5173)

**é¢„æœŸè¾“å‡º**:
```
  VITE v5.0.8  ready in 1234 ms

  âœ  Local:   http://localhost:5173/
  âœ  Network: http://192.168.x.x:5173/
  âœ  press h to show help
```

---

### Step 4: éªŒè¯åŠŸèƒ½

è®¿é—® [http://localhost:5173](http://localhost:5173)ï¼Œåº”çœ‹åˆ°ï¼š

1. **é¡¶éƒ¨å¯¼èˆªæ **: NegotiaPro AI Logo + ä¸‰ä¸ªTab (æˆ˜å‰å‡†å¤‡/æˆ˜ä¸­è¾…åŠ©/æˆ˜åå¤ç›˜)
2. **é»˜è®¤é¡µé¢**: æˆ˜å‰å‡†å¤‡ (Intelligence Page)
3. **æœç´¢æ¡†**: "å¯¹æ‰‹ç”»åƒåˆ†æ" è¾“å…¥æ¡† + "ç”Ÿæˆå†…å‚" æŒ‰é’®

**æµ‹è¯•æµç¨‹**:
```
1. åœ¨æœç´¢æ¡†è¾“å…¥: ä¸­å…³æ‘é“¶è¡Œ
2. ç‚¹å‡» "ç”Ÿæˆå†…å‚" æŒ‰é’®
3. ç­‰å¾…1-2ç§’ï¼Œåº”æ˜¾ç¤ºå®Œæ•´èµ„æ–¹æŠ¥å‘Š:
   - åŸºæœ¬ä¿¡æ¯ (åç§°/ç±»å‹/åˆä½œçŠ¶æ€)
   - ä¸šåŠ¡æ•°æ® (åœ¨è´·ä½™é¢/æ”¾æ¬¾è§„æ¨¡)
   - è¿è¥æ•°æ® (é€šè¿‡ç‡/M3+)
   - å•†åŠ¡æ¡ä»¶ (ä¿è¯é‡‘/èµ„é‡‘æˆæœ¬)
   - è°ˆåˆ¤å»ºè®® (3å¥—æ–¹æ¡ˆ)
```

---

## ğŸ¨ é¡µé¢åŠŸèƒ½è¯´æ˜

### 1. æˆ˜å‰å‡†å¤‡ (Intelligence Page)

**åŠŸèƒ½**: ç”Ÿæˆèµ„æ–¹å†…å‚æŠ¥å‘Š

**æ“ä½œæ­¥éª¤**:
1. è¾“å…¥èµ„æ–¹åç§° (å¦‚: ä¸­å…³æ‘é“¶è¡Œ)
2. ç‚¹å‡» "ç”Ÿæˆå†…å‚"
3. æŸ¥çœ‹å®Œæ•´æŠ¥å‘Šå’Œè°ˆåˆ¤ï¿½ï¿½æ¡ˆ

**æ•°æ®æ¥æº**: å½“å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œåç»­æ¥å…¥Dataphin

---

### 2. æˆ˜ä¸­è¾…åŠ© (Live Copilot Page)

**åŠŸèƒ½**: å®æ—¶è¯æœ¯æ¨è

**æ“ä½œæ­¥éª¤**:
1. ç‚¹å‡»é¡¶éƒ¨ "æˆ˜ä¸­è¾…åŠ©" Tab
2. åœ¨åº•éƒ¨è¾“å…¥æ¡†è¾“å…¥å¯¹æ–¹å‘è¨€ (å¦‚: "ä¿è¯é‡‘å¿…é¡»æåˆ°10%")
3. ç‚¹å‡» "è·å–æ¨è" æŒ‰é’®
4. æŸ¥çœ‹AIæ¨èçš„è¯æœ¯ (å·¦ä¾§æ˜¾ç¤ºå¯¹è¯è®°å½•ï¿½ï¿½å³ä¾§æ˜¾ç¤ºè¯æœ¯æ¨è)
5. ç‚¹å‡» "ä½¿ç”¨æ­¤è¯æœ¯" å°†è¯æœ¯æ·»åŠ åˆ°å¯¹è¯è®°å½•
6. ç»“æŸåç‚¹å‡» "ç”Ÿæˆå¤ç›˜" æŒ‰é’®

**ç‰¹è‰²åŠŸèƒ½**:
- ğŸ™ï¸ å¼€å§‹/åœæ­¢å½•éŸ³ (Demoç‰ˆæš‚æœªå®ç°è¯­éŸ³è¯†åˆ«)
- ğŸ“‹ è‡ªåŠ¨ç”Ÿæˆå¤ç›˜æŠ¥å‘Š
- ğŸ—‘ï¸ æ¸…ç©ºå¯¹è¯è®°å½•

---

### 3. æˆ˜åå¤ç›˜ (Workflow Page)

**åŠŸèƒ½**: è°ˆåˆ¤è®°å½•ç®¡ç†ä¸åˆ†æ

**æ“ä½œæ­¥éª¤**:
1. ç‚¹å‡»é¡¶éƒ¨ "æˆ˜åå¤ç›˜" Tab
2. æŸ¥çœ‹å†å²è°ˆåˆ¤è®°å½•åˆ—è¡¨
3. ç‚¹å‡» "æŸ¥çœ‹è¯¦æƒ…" æ‰“å¼€å®Œæ•´å¤ç›˜æŠ¥å‘Š
4. ç‚¹å‡» "å¯¼å‡ºæŠ¥å‘Š" ä¸‹è½½TXTæ ¼å¼æŠ¥å‘Š

**ç­›é€‰åŠŸèƒ½**:
- å…¨éƒ¨/å·²å®Œæˆ/å¾…å®Œæˆ
- æœç´¢èµ„æ–¹åç§°æˆ–å…³é”®è¯

**ç»Ÿè®¡æ•°æ®**:
- æ€»è®°å½•æ•°
- å·²å®Œæˆæ•°
- å¾…å®Œæˆæ•°
- å¯¹è¯æ€»æ•°

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜1: åç«¯å¯åŠ¨å¤±è´¥ - ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**:
```
ERROR:    [Errno 48] Address already in use
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# macOS/Linux: æŸ¥æ‰¾å ç”¨8000ç«¯å£çš„è¿›ç¨‹
lsof -i :8000

# æ€æ­»è¿›ç¨‹
kill -9 <PID>

# æˆ–è€…ä¿®æ”¹ç«¯å£
# ç¼–è¾‘ backend/main.py æœ€åä¸€è¡Œ:
uvicorn.run(app, host="0.0.0.0", port=8001)  # æ”¹ä¸º8001
```

---

### é—®é¢˜2: å‰ç«¯å¯åŠ¨å¤±è´¥ - ä¾èµ–å®‰è£…é”™è¯¯

**é”™è¯¯ä¿¡æ¯**:
```
npm ERR! code ERESOLVE
npm ERR! ERESOLVE could not resolve
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…é™¤npmç¼“å­˜
npm cache clean --force

# åˆ é™¤node_moduleså’Œpackage-lock.json
rm -rf node_modules package-lock.json

# é‡æ–°å®‰è£…
npm install

# æˆ–ä½¿ç”¨ --legacy-peer-deps
npm install --legacy-peer-deps
```

---

### é—®é¢˜3: APIè¯·æ±‚å¤±è´¥ - CORSè·¨åŸŸé”™è¯¯

**é”™è¯¯ä¿¡æ¯** (æµè§ˆå™¨Console):
```
Access to fetch at 'http://localhost:8000/api/...' from origin 'http://localhost:5173' has been blocked by CORS policy
```

**è§£å†³æ–¹æ¡ˆ**:
- âœ… æ£€æŸ¥åç«¯æ˜¯å¦å¯åŠ¨ (è®¿é—® http://localhost:8000/docs)
- âœ… æ£€æŸ¥ `backend/main.py` ä¸­CORSé…ç½®æ˜¯å¦åŒ…å« `http://localhost:5173`
- âœ… é‡å¯åç«¯æœåŠ¡

---

### é—®é¢˜4: å‰ç«¯æ˜¾ç¤ºç©ºç™½é¡µ

**æ’æŸ¥æ­¥éª¤**:
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
2. æŸ¥çœ‹ Console æ˜¯å¦æœ‰JavaScripté”™è¯¯
3. æŸ¥çœ‹ Network æ ‡ç­¾é¡µï¼ŒAPIè¯·æ±‚æ˜¯å¦æ­£å¸¸

**å¸¸è§åŸå› **:
- åç«¯æœªå¯åŠ¨
- APIåœ°å€é…ç½®é”™è¯¯
- æµè§ˆå™¨ç¼“å­˜é—®é¢˜ (Ctrl+Shift+R å¼ºåˆ¶åˆ·æ–°)

---

## ğŸ“‚ é¡¹ç›®ç»“æ„è¯´æ˜

```
negotiation_assistant_web/
â”‚
â”œâ”€â”€ frontend/                          # Reactå‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/                     # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Intelligence.jsx       # æˆ˜å‰å‡†å¤‡é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Intelligence.css       # æˆ˜å‰å‡†å¤‡æ ·å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ LiveCopilot.jsx        # æˆ˜ä¸­è¾…åŠ©é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ LiveCopilot.css        # æˆ˜ä¸­è¾…åŠ©æ ·å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ Workflow.jsx           # æˆ˜åå¤ç›˜é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ Workflow.css           # æˆ˜åå¤ç›˜æ ·å¼
â”‚   â”‚   â”œâ”€â”€ App.jsx                    # ä¸»åº”ç”¨ç»„ä»¶ (å¯¼èˆªç³»ç»Ÿ)
â”‚   â”‚   â”œâ”€â”€ App.css                    # ä¸»åº”ç”¨æ ·å¼
â”‚   â”‚   â”œâ”€â”€ main.jsx                   # Reactå…¥å£æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ index.css                  # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ index.html                     # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ package.json                   # npmä¾èµ–é…ç½®
â”‚   â””â”€â”€ vite.config.js                 # Viteæ„å»ºé…ç½®
â”‚
â”œâ”€â”€ backend/                           # FastAPIåç«¯
â”‚   â”œâ”€â”€ main.py                        # FastAPIä¸»å…¥å£ + APIè·¯ç”±
â”‚   â””â”€â”€ requirements.txt               # Pythonä¾èµ–åˆ—è¡¨
â”‚
â”œâ”€â”€ README.md                          # é¡¹ç›®è¯´æ˜
â””â”€â”€ SETUP_GUIDE.md                     # æœ¬æ–‡æ¡£
```

---

## ğŸ”Œ APIæ¥å£è¯´æ˜

### 1. ç”Ÿæˆå†…å‚æŠ¥å‘Š

```http
POST /api/intelligence/generate
Content-Type: application/json

Request Body:
{
  "funder_name": "ä¸­å…³æ‘é“¶è¡Œ"
}

Response:
{
  "success": true,
  "data": {
    "fund_name": "ä¸­å…³æ‘é“¶è¡Œ",
    "fund_type": "é“¶è¡Œ",
    "cooperation_status": "æ­£å¸¸",
    "outstanding_balance": 8750,
    "last_month_loan": 1200,
    "current_month_plan": 800,
    "approval_rate": 62.3,
    "avg_approval_days": 2.1,
    "m3_overdue_rate": 4.8,
    "funding_cost": 7.2,
    "deposit_rate": 5.0,
    "cooperation_mode": "é£é™©å…±æ‹…",
    "contacts": [...],
    "negotiation_plans": [...]
  }
}
```

---

### 2. è¯æœ¯åŒ¹é…

```http
POST /api/playbook/match
Content-Type: application/json

Request Body:
{
  "user_input": "ä¿è¯é‡‘å¿…é¡»æåˆ°10%"
}

Response:
{
  "success": true,
  "data": [
    {
      "id": "script_001",
      "name": "é˜¶æ¢¯å¼ä¿è¯é‡‘æ–¹æ¡ˆ",
      "scene": "å®‰å…¨å«è°ˆåˆ¤",
      "content": "ç†è§£è¯„å®¡å§”å‘˜ä¼šç«‹åœºã€‚10%ç¡®å®è¶…å‡ºæˆ‘ä»¬æ‰¿å—èƒ½åŠ›...",
      "tips": "ä¸ç›´æ¥æ‹’ç»ï¼Œå…ˆæé˜¶æ¢¯æ–¹æ¡ˆæµ‹è¯•åº•çº¿"
    },
    ...
  ]
}
```

---

### 3. å®æ—¶æ¨è (ä¸è¯æœ¯åŒ¹é…ç›¸åŒ)

```http
POST /api/realtime/recommend
Content-Type: application/json

(å‚æ•°å’Œå“åº”ä¸ /api/playbook/match ç›¸åŒ)
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸ (1-2å‘¨)
- [ ] é›†æˆçœŸå®Dataphinæ•°æ®æº
- [ ] ä»CLIç‰ˆè¿ç§»è¯æœ¯åŒ¹é…ç®—æ³•
- [ ] å¢åŠ æ›´å¤šçœŸå®èµ„æ–¹æ¡ˆä¾‹
- [ ] ä¼˜åŒ–å“åº”å¼è®¾è®¡ (ç§»åŠ¨ç«¯é€‚é…)

### ä¸­æœŸ (1-2æœˆ)
- [ ] å¢åŠ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] å®ç°WebSocketå®æ—¶é€šä¿¡
- [ ] æ•°æ®åº“é›†æˆ (PostgreSQL)
- [ ] è¯­éŸ³è¯†åˆ«åŠŸèƒ½ (è®¯é£/ç™¾åº¦API)

### é•¿æœŸ (3-6æœˆ)
- [ ] æ•°æ®å¯è§†åŒ– (ECharts)
- [ ] å›¢é˜Ÿåä½œåŠŸèƒ½
- [ ] æƒé™ç®¡ç†ç³»ç»Ÿ
- [ ] æµç¨‹ç³»ç»Ÿé›†æˆ

---

## ğŸ’¡ å¼€å‘æç¤º

### ä¿®æ”¹åç«¯API

1. ç¼–è¾‘ `backend/main.py`
2. ä¿®æ”¹å¯¹åº”çš„è·¯ç”±å‡½æ•°
3. ä¿å­˜åè‡ªåŠ¨é‡å¯ (uvicorn --reload)

**ç¤ºä¾‹**: ä¿®æ”¹ä¸­å…³æ‘é“¶è¡Œæ¨¡æ‹Ÿæ•°æ®
```python
# backend/main.py ç¬¬30è¡Œå·¦å³
"outstanding_balance": 9999,  # ä¿®æ”¹åœ¨è´·ä½™é¢
```

---

### ä¿®æ”¹å‰ç«¯æ ·å¼

1. ç¼–è¾‘å¯¹åº”çš„ `.css` æ–‡ä»¶ (å¦‚ `Intelligence.css`)
2. ä¿®æ”¹é¢œè‰²/å¸ƒå±€
3. ä¿å­˜åæµè§ˆå™¨è‡ªåŠ¨çƒ­æ›´æ–°

**ç¤ºä¾‹**: ä¿®æ”¹ä¸»è‰²è°ƒ
```css
/* Intelligence.css */
.generate-btn {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  /* ä»ç´«è‰²æ”¹ä¸ºçº¢è‰² */
}
```

---

### è°ƒè¯•æŠ€å·§

**å‰ç«¯è°ƒè¯•**:
- ä½¿ç”¨ `console.log()` æ‰“å°å˜é‡
- Chrome DevTools (F12) â†’ Console/Network
- React DevTools æµè§ˆå™¨æ’ä»¶

**åç«¯è°ƒè¯•**:
- ä½¿ç”¨ `print()` æ‰“å°è¯·æ±‚æ•°æ®
- æŸ¥çœ‹ç»ˆç«¯è¾“å‡º
- è®¿é—® http://localhost:8000/docs æµ‹è¯•API

---

## ğŸ“ è·å–å¸®åŠ©

### å¸¸è§é—®é¢˜
1. **å¦‚ä½•ä¿®æ”¹ç«¯å£?**
   - å‰ç«¯: `frontend/vite.config.js` â†’ `server.port`
   - åç«¯: `backend/main.py` æœ€åä¸€è¡Œ â†’ `port=8000`

2. **å¦‚ä½•æ·»åŠ æ–°é¡µé¢?**
   - åœ¨ `frontend/src/pages/` åˆ›å»ºæ–°ç»„ä»¶
   - åœ¨ `App.jsx` ä¸­æ·»åŠ è·¯ç”±

3. **å¦‚ä½•éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ?**
   - å‰ç«¯: `npm run build` ç”Ÿæˆé™æ€æ–‡ä»¶
   - åç«¯: ä½¿ç”¨ Gunicorn/Nginx

---

## âœ… éªŒæ”¶æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼Œç¡®è®¤å®‰è£…æˆåŠŸï¼š

```
â–¡ åç«¯æˆåŠŸå¯åŠ¨ (http://localhost:8000/docs å¯è®¿é—®)
â–¡ å‰ç«¯æˆåŠŸå¯åŠ¨ (http://localhost:5173 å¯è®¿é—®)
â–¡ Intelligenceé¡µé¢: è¾“å…¥"ä¸­å…³æ‘é“¶è¡Œ"ï¼Œç”Ÿæˆå†…å‚æŠ¥å‘ŠæˆåŠŸ
â–¡ Live Copiloté¡µé¢: è¾“å…¥å¯¹æ–¹å‘è¨€ï¼Œè·å–è¯æœ¯æ¨èæˆåŠŸ
â–¡ Workflowé¡µé¢: æŸ¥çœ‹å†å²è®°å½•ã€å¯¼å‡ºæŠ¥å‘ŠæˆåŠŸ
â–¡ ä¸‰ä¸ªTabåˆ‡æ¢æ­£å¸¸ï¼Œæ— æŠ¥é”™
```

---

**æœ€åæ›´æ–°**: 2026-02-11
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**é€‚ç”¨ç‰ˆæœ¬**: NegotiaPro AI Web v0.1.0
