# 资金商务谈判助手 🤝

> 基于MCP的AI谈判支持系统 - 让每一次外勤都成为数字资产，让每一次博弈都有数智最优解

[![GitHub](https://img.shields.io/badge/GitHub-Repository-blue?logo=github)](https://github.com/Galirischen/negotiation_assistant_web)
[![Demo](https://img.shields.io/badge/Demo-Online-success?logo=react)](http://localhost:5173)
[![Version](https://img.shields.io/badge/version-v0.2.0-orange)](https://github.com/Galirischen/negotiation_assistant_web/releases)

---

## 📌 目录

- [项目背景与痛点](#项目背景与痛点)
- [目标价值](#目标价值)
- [整体思路](#整体思路)
- [实施过程](#实施过程)
- [效果预估](#效果预估)
- [典型应用场景](#典型应用场景)
- [总结反思](#总结反思)
- [快速启动](#快速启动)
- [核心功能](#核心功能)
- [项目结构](#项目结构)
- [技术栈](#技术栈)
- [API文档](#api文档)

---

## 🎯 项目背景与痛点

### 一、员工层面的挑战

#### 1. **信息差 - 现场被"数据攻击"无法应对**

**痛点场景**:
- 商务谈判现场,对方抛出复杂数据(如"你们的年化终损达到xx%,高于同业均值2个点")
- 无法即时校验数据真实性和合理性
- 临时计算困难,容易被对方数据"带节奏"
- 缺少历史数据支撑,错失反驳机会

**影响**:
- 谈判主动权被动
- 商务条件被迫让步
- 事后发现被"忽悠",但为时已晚

#### 2. **临场应变 - 高压环境下的心理博弈**

**痛点场景**:
- 对方突然以"合规施压"(如"你们这个模式有监管风险")
- 遇到从未见过的刁钻问题或新型要求
- 情绪波动导致表达不清晰或过度承诺
- 缺乏标准化话术,每次都靠临场发挥

**影响**:
- 压力巨大,影响当场反馈结果的质量
- 谈判质量不稳定,结果随机性大
- 新人成长周期长(3-6个月才能独立谈判)

#### 3. **手工处理 - 低效的会前会后工作**

**痛点场景**:
- 每次拜访前需手动拉取资方数据(在贷余额、通过率、成本等)
- 准备一份背景会议单耗时0.5-1小时
- 会后整理纪要、提取关键信息又是1小时
- 数据散落在多个系统(Dataphin、线下手工表、协议管理系统)

**影响**:
- 商务时间消耗在数据准备而非谈判本身
- 紧急会议准备不充分,影响谈判效果
- 重复劳动,缺乏沉淀

#### 4. **领导参会 - 需帮助领导快速熟悉资方细节**

**痛点场景**:
- 重要拜访时VP或部门负责人参会
- 领导层对资方的历史数据、运营状况不熟悉
- 现场需要商务人员补充背景信息
- 影响专业形象和谈判节奏

**影响**:
- 错失关键谈判机会
- 领导决策缺乏数据支持
- 团队专业度打折扣

---

### 二、管理层面的困境

#### 1. **经验黑盒 - 核心知识的流失风险**

**痛点场景**:
- 顶尖商务的谈判技巧和经验只存在于个人脑中
- 缺少系统化的知识管理和传承机制
- 关键人员离职,公司智力资产流失
- 新人只能通过"师傅带徒弟"的低效方式学习

**影响**:
- 组织能力脆弱,过度依赖个人
- 培训成本高,周期长
- 无法规模化复制优秀经验

#### 2. **过程管理 - 谈判及拜访"黑箱"难以监控**

**痛点场景**:
- 外出拜访、谈判占商务工作50%,但效率和质量难以掌握
- 领导只能看到最终商务条件、签约结果
- 不知道过程中放弃了哪些原本可以坚持的条件
- 缺少标准化的谈判SOP和评估机制

**影响**:
- 无法识别低效谈判行为
- 丢失优化空间,成本浪费
- 团队能力提升缓慢

#### 3. **结果评估 - 无法判断"最优解"**

**痛点场景**:
- 谈判结束后,不知道结果是否是最优解
- 缺少对标基准(同类资方的市场行情)
- 很少进行系统性复盘和经验总结
- 重复犯错,缺少闭环改进

**影响**:
- 错失更优商务条件
- 资金成本优化空间被浪费
- 组织学习能力弱

#### 4. **资方画像缺失 - 战略资产未沉淀**

**痛点场景**:
- 缺少对资方谈判偏好的系统分析
- 不知道哪些机构看重合规、哪些对价格敏感
- 每次谈判都是"重新开始",无法利用历史经验
- 无法预测资方风险政策调整趋势

**影响**:
- 谈判策略盲目,命中率低
- 战略合作决策缺乏支持
- 珍贵的对手画像资产流失

---

## 🎁 目标价值

### 一、量化改进目标

| 维度 | 改进前 | 改进后 | 提升幅度 |
|------|--------|--------|----------|
| **数据准备时长** | 2小时/次 | 3-5分钟 | **96%效率提升** |
| **数据调取速度** | 跨系统手动查询 | 秒级响应 | **实时化** |
| **新人培训周期** | 3-6个月 | 1-2个月 | **50-66%缩短** |
| **谈判复盘频率** | 0次/年 | 12-4次/年 | **从无到有** |
| **话术标准化** | 依赖个人发挥 | 系统化话术库 | **可复制** |
| **领导参会效率** | 需现场补充背景 | 提前同步完整档案 | **决策质量提升** |

### 二、核心价值主张

#### 1. **实时智能支持 - 让每个商务都趋近专业高手**

- 🎙️ **实时谈判模式**: 监听对方发言,秒级推荐应对话术
- 💬 **话术智能匹配**: 800+场景话术库,自动匹配最佳应对
- 📊 **数据即时校验**: 对方抛出数据时,系统自动计算验证
- 🛡️ **合规风险预警**: 对方提出不合规要求时,立即提醒红线

**价值**: 新人也能应对复杂谈判,团队整体战斗力提升

#### 2. **资方内参系统 - 知己知彼,百战不殆**

- 📈 **业务数据实时**: 在贷余额、放款规模、排期情况(Dataphin直连)
- 📊 **运营数据透明**: 通过率、审批时长、保证金退回时效
- 💰 **商务条件对比**: 资金成本、保证金比例、同品类对标
- 👔 **关键联系人档案**: 分管领导、部门负责人、商务对接人
- 🧠 **谈判偏好画像**: 机构风格分析(合规导向/价格敏感/效率优先)

**价值**: 3分钟生成完整资方档案,领导参会也能"了如指掌"

#### 3. **知识资产沉淀 - 从个人能力到组织能力**

- 📚 **谈判经验固化**: 顶尖商务的话术和策略系统化
- 🔄 **持续学习迭代**: 每次谈判记录自动沉淀,话术库持续优化
- 🎓 **新人快速成长**: 从"3-6个月实践出真知"到"1-2个月体系化培训"
- 🔒 **降低人员风险**: 核心知识不再流失

**价值**: 组织能力可积累、可复制、可传承

#### 4. **过程管理可视化 - 让谈判不再是"黑箱"**

- 📝 **谈判全程记录**: 自动生成会议纪要和关键决策点
- 📊 **复盘报告生成**: 1个月/3个月周期复盘,识别改进空间
- 🎯 **结果评估对标**: 对比市场行情,评估谈判最优性
- 📈 **团队能力诊断**: 识别高效/低效谈判行为

**价值**: 管理层掌握过程,优化决策,持续改进

#### 5. **管理层数据分析 - 从经验管理到数据驱动**

- 📊 **外勤效率统计**: 自动记录每次谈判/拜访的时间、资方、场景、结果
- 📈 **员工业绩分析**:
  - 谈判成功率(按员工/资方类型/场景维度)
  - 商务条件优化幅度(资金成本降低、保证金比例优化)
  - 平均谈判周期(从接触到签约)
- 🎯 **团队能力画像**:
  - 识别高效商务的行为模式
  - 发现低效环节和改进空间
  - 新人成长曲线追踪
- 📋 **管理决策支持**:
  - 资方合作健康度评估(哪些资方值得深耕)
  - 商务资源分配优化(重点资方配置资深商务)
  - 培训需求识别(哪些场景需要加强)

**价值**: 从"拍脑袋"到数据驱动,提升团队整体效能

---

## 💡 整体思路

### 一、设计理念

```
传统模式: 人工经验 + 临场发挥 + 事后补救
         ↓
AI增强模式: 数据支撑 + 实时辅助 + 系统沉淀
```

### 二、四大核心能力

#### 1. **实时谈判支持** (Real-time Negotiation Assistant)

```
对方发言 → 语音/文字识别 → 场景匹配 → 话术推荐 → 实时弹窗
                                    ↓
                              数据校验 + 风险预警
```

**关键技术**:
- 语音识别(ASR) + 自然语言理解(NLU)
- 话术匹配引擎(基于关键词+语义相似度)
- 实时弹窗提示(非侵入式UI)

#### 2. **资方内参系统** (Funder Intelligence Report)

```
资方名称 → Dataphin查询 → 数据聚合 → 智能分析 → 内参报告
             (MCP协议)      ↓            ↓
                     CRM联系人   谈判建议生成
```

**数据维度**:
- ✅ 合作状态(正常/暂停/终止)
- ✅ 业务数据(在贷余额、放款规模、本月排期)
- ✅ 运营数据(通过率、审批时长)
- ✅ 商务条件(资金成本、保证金、合作模式)
- ✅ 关键联系人(分管领导、部门负责人、商务对接人)
- 🚧 谈判偏好画像(待积累)

#### 3. **话术知识库** (Playbook System)

```
场景分类 → 标准话术 → 使用技巧 → 成功案例 → 持续优化
   ↓
(价格谈判、风险质疑、合规施压...)
```

**话术库结构**:
- 🏷️ **场景标签**: 价格谈判、风险质疑、合规施压、业务量承诺...
- 💬 **标准话术**: 经过验证的高效表达
- 💡 **使用技巧**: 何时用、如何用、注意事项
- 📊 **数据支撑**: 话术涉及的关键数据引用
- ⚠️ **风险提示**: 避免踩坑的提醒

#### 4. **复盘分析系统** (Post-negotiation Analysis)

```
谈判记录 → 关键决策提取 → 结果对标 → 改进建议 → 知识沉淀
              ↓                ↓
        条件让步分析    市场行情对比
```

**输出内容**:
- 📝 会议纪要(自动生成)
- 🎯 关键决策点回顾
- 📊 结果评估(vs市场行情)
- 💡 改进建议
- 📚 经验沉淀(更新话术库)

---

## 🏗️ 实施过程

### Phase 1: Web化改造与权限体系 ✅

**目标**: 将CLI工具转换为Web应用，建立完整的权限管理体系

**实施内容**:
- ✅ **前端架构搭建**
  - React 18 + Vite构建现代化单页应用
  - React Router实现页面路由
  - Context API管理全局状态
  - 统一的UI设计系统和样式规范

- ✅ **后端API开发**
  - FastAPI框架构建RESTful API
  - Pydantic模型进行数据验证
  - JWT Token实现无状态认证
  - CORS配置支持跨域请求

- ✅ **权限管理系统**
  - 三级角色体系: 商务 < 组长 < 部门负责人
  - 基于角色的数据隔离机制
  - 权限守卫组件保护敏感页面
  - Token自动刷新和过期处理

- ✅ **核心功能页面**
  - 战前准备: 资方内参报告 + 话术知识库
  - 战中辅助: 实时对话记录 + 话术推荐
  - 战后复盘: 谈判记录管理 + 待办追踪
  - 团队看板: 效能分析 + 成员业绩

**技术亮点**:
- 组件化设计，代码复用率高
- 响应式布局，适配不同屏幕
- 权限系统灵活可扩展
- Demo数据完整，可独立演示

### Phase 2: 数据集成与持久化 🚧

**目标**: 接入真实数据源，实现数据持久化存储

**计划内容**:
- [ ] **Dataphin数据源接入**
  - 通过MCP协议连接Dataphin
  - 实时查询资方业务数据
  - 数据缓存机制优化性能
  - 数据更新频率配置

- [ ] **数据库集成**
  - PostgreSQL作为主数据库
  - 谈判记录、待办事项持久化
  - 用户权限数据管理
  - 数据备份和恢复机制

- [ ] **历史数据迁移**
  - CLI版本数据导入工具
  - 数据格式转换和清洗
  - 数据完整性校验
  - 增量同步机制

### Phase 3: 智能化增强 🚧

**目标**: 提升AI辅助能力，优化用户体验

**计划内容**:
- [ ] **实时通信优化**
  - WebSocket实现双向通信
  - 实时话术推荐延迟<500ms
  - 多人协同谈判支持
  - 消息队列处理高并发

- [ ] **语音功能集成**
  - 接入ASR语音识别服务
  - 实时语音转文字
  - 支持多种音频格式
  - 噪音过滤和优化

- [ ] **话术推荐算法**
  - 基于语义相似度的匹配
  - 上下文感知的推荐
  - 用户反馈学习机制
  - A/B测试优化效果

### Phase 4: 企业系统集成 🔮

**目标**: 打通业务闭环，实现全流程数字化

**计划内容**:
- [ ] **BPM工单系统集成**
  - 战后复盘一键触发协议审批流程
  - 自动创建跟进工单和任务
  - 审批状态实时同步到谈判记录
  - 协议签署流程自动化

- [ ] **CRM系统打通**
  - 资方特性标签自动提取和沉淀
  - 谈判历史与CRM客户档案联动
  - 资方画像数据资产化（偏好分析、风险等级、合作潜力）
  - 客户生命周期管理集成

- [ ] **业务流程自动化**
  - 谈判结果自动同步到业务系统
  - 待办事项与OA系统集成
  - 数据双向同步机制
  - 跨系统数据一致性保障

**价值**: 从谈判到签约全流程数字化，沉淀可复用的资方数据资产

---

## 📊 效果预估

### 一、效率提升

| 指标 | 当前状态 | 预期目标 | 提升幅度 |
|------|---------|---------|----------|
| **会前准备时长** | 2小时 | 5分钟 | **96%** |
| **数据查询速度** | 跨系统手动 | 秒级响应 | **实时化** |
| **会后整理时长** | 1小时 | 10分钟 | **83%** |
| **新人培训周期** | 3-6个月 | 1-2个月 | **50-66%** |

### 二、质量改善

- **谈判成功率**: 从60%提升至75%（预估）
- **商务条件优化**: 平均资金成本降低0.3-0.5个百分点
- **决策准确性**: 数据支撑减少主观判断失误
- **合规风险**: 实时预警避免踩红线

### 三、管理价值

- **过程可视化**: 100%谈判过程可追溯
- **知识沉淀**: 每年积累200+场谈判经验
- **团队能力**: 标准化培训体系建立
- **战略决策**: 数据驱动的资方合作策略

### 四、长期收益

- **组织能力**: 从依赖个人到系统化能力
- **数据资产**: 资方画像库持续增值
- **竞争优势**: 专业度和效率领先同业
- **成本节约**: 年度资金成本优化预计节省数百万

---

## 💼 典型应用场景

### 真实案例: 股东变更应对 - 中关村银行保证金谈判

**业务背景**:
- **时间**: 2026年1月
- **事件**: 公司股东变更,第一大股东分众传媒退出
- **影响**: 中关村银行评审委员会要求将保证金比例从1%提升至3-5%
- **压力**: 若接受3%将新增保证金5540万,严重影响资金效率和现金流

**传统方式的困境**:
- ❌ 准备资料需2小时: 手动查询Dataphin、整理历史数据、准备谈判策略
- ❌ 应对话术靠经验: 新商务缺乏应对股东变更质疑的标准话术
- ❌ 数据支撑不足: 现场需要的资产质量数据难以快速查询
- ❌ 方案设计耗时: 保证金替代方案需要临时构思,容易遗漏

**使用工具后的全流程**:

#### 1️⃣ 战前准备 - 5分钟生成完整策略

**输入场景**: "中关村银行因股东变更要求提升保证金比例"

**系统输出**:

✅ **应对股东变更质疑的话术**
```
"理解您的关切。此次股东变更是战略调整的一部分:
• 分众传媒作为财务投资人阶段性退出,这是正常的资本运作
• 股权变更由管理层主动回购,更加坚定助贷业务发展
• 管理层持股65%且保持稳定,决策效率更高
• 公司运营指标正常,监管部门已完成备案审查"
```

✅ **三套保证金替代方案**
- **方案A**: 渐进式调整(前3月2%,后续视表现恢复1%)
- **方案B**: 存款支持(维持1%+3000万专户存款)  ⭐推荐
- **方案C**: 业务量置换(2%保证金+授信额度提升5亿)

✅ **数据支撑材料清单**
- 2025年Q4资产质量改善数据
- 风控措施优化方案
- 股东变更声明文件
- 2026年Q1业务计划

---

#### 2️⃣ 资方内参 - 秒级查询关键数据

**输入**: "查询中关村银行情报"

**系统输出**:

📊 **业务数据**
- 在贷余额: 27.7亿元(额度使用率92.3%,接近瓶颈)
- 放款量趋势: 近期出现下滑,需关注

📈 **资产质量表现**
- 首逾FPD15+: 1.09% → 0.90% ✅改善明显
- M1 30+回收率: 80.4% ✅回升趋势
- 入催率: 8.74% → 7.55% ✅优化显著

💡 **谈判策略建议**
- 用"改善趋势"对冲"短逾风险"
- 用"提额需求"置换"保证金压力"
- 建立"透明沟通机制"增强信任

---

#### 3️⃣ 战中辅助 - 实时话术推荐

**对方质疑**: "你们最近发生股东变更,是不是公司经营出现了重大问题?"

**系统推荐** (0.5秒响应):
```
✅ 推荐话术: 透明化沟通 + 数据支撑
💡 技巧: 不回避问题,用"管理层主动回购"定性,强化信心
⚠️ 风险提示: 避免含糊其辞,会加重对方疑虑
```

**对方施压**: "评审委员会要求保证金提升到3-5%"

**系统推荐**:
```
✅ 推荐方案B: 存款支持方案
  • 维持保证金1%不变
  • 额外提供3000万存款支持(存入代偿账户)
  • 1-2个月后根据资产表现释放
  • 优势: 灵活可逆,双方都能接受

💡 话术要点:
  • 量化3%保证金的影响(新增5540万)
  • 强调存款支持的灵活性和可逆性
  • 明确释放条件(首逾<1%,回收率>80%)
```

---

#### 4️⃣ 战后复盘 - 经验沉淀

**谈判结果**:
- ✅ 避免保证金从1%直接提升至3%(节省5540万占用)
- ✅ 采用3000万存款支持方案(1-2个月可释放)
- ✅ 建立透明沟通机制(每月报告+每两周会议)
- ✅ 保持业务合作可持续性

**系统自动记录**:
- 🎯 成功话术: "存款支持方案"被标记为高效话术
- 📊 关键数据: 对方对"改善趋势"敏感度高于"绝对值"
- 💡 经验沉淀: 股东变更应对策略更新到知识库
- 🔄 持续优化: 下次遇到类似场景可直接调用

---

### 价值量化

| 维度 | 传统方式 | 使用工具后 | 提升 |
|------|---------|-----------|------|
| **准备时长** | 2小时 | 5分钟 | **96%** |
| **数据查询** | 30分钟 | 5秒 | **实时化** |
| **话术质量** | 依赖个人经验 | 基于历史成功案例 | **标准化** |
| **方案完整性** | 2-3个方案 | 3个方案+对比表 | **结构化** |
| **经验传承** | 留在个人脑中 | 自动沉淀到系统 | **可复用** |

**业务成果**:
- 💰 节省保证金占用: **5540万** → **3000万**(可释放)
- ⏱️ 谈判准备效率: 提升 **96%**
- 👥 新人成长加速: 可直接使用标准化话术应对复杂场景
- 📚 组织能力提升: 从依赖个人到系统化能力

---

### 适用场景扩展

除了股东变更应对,该工具同样适用于:

1. **资金成本谈判** - 从8.5%降至7.8%的策略设计
2. **保证金条款谈判** - 多方案对比与灵活调整机制
3. **风险质疑应对** - 数据拆解与改善趋势证明
4. **合规施压应对** - 实时预警避免踩红线
5. **业务量承诺** - 用让步换取业务增长空间
6. **新机构破冰** - 首次合作的信任建立策略

**关键成功因素**:
- ✅ 话术来自真实成功案例,而非理论构想
- ✅ 数据实时查询,避免"拍脑袋"决策
- ✅ 方案结构化对比,提升专业度
- ✅ 经验自动沉淀,持续优化迭代

---

## 🤔 总结反思

### 一、项目创新点

1. **AI+业务深度融合**: 不是简单的工具堆砌，而是深入理解资金商务场景，将AI能力嵌入到实际工作流程中

2. **从个人工具到组织能力**: 通过权限体系和数据沉淀，将个人经验转化为组织资产

3. **全流程覆盖**: 战前-战中-战后完整闭环，不留管理盲区

4. **数据驱动决策**: 用数据说话，减少主观判断，提升决策质量

### 二、实施挑战

1. **数据质量**: Dataphin数据的准确性和及时性直接影响系统价值
   - **应对**: 建立数据校验机制，人工审核关键数据

2. **用户习惯**: 从传统工作方式到数字化工具需要适应期
   - **应对**: 分阶段推广，先从核心用户试点，逐步扩大范围

3. **系统集成**: 与BPM、CRM等企业系统对接存在技术复杂度
   - **应对**: 采用标准化接口，分阶段实施，先实现核心功能

4. **知识更新**: 话术库和策略需要持续维护和优化
   - **应对**: 建立反馈机制，定期复盘更新，形成闭环

### 三、未来展望

1. **智能化升级**: 引入大语言模型，实现更智能的话术生成和策略建议

2. **移动端支持**: 开发移动App，支持外勤场景的实时使用

3. **行业扩展**: 将经验复制到其他需要商务谈判的业务场景

4. **生态建设**: 打通更多企业系统，形成完整的商务数字化生态

### 四、关键成功因素

- ✅ **领导支持**: 管理层认可和推动是项目成功的前提
- ✅ **用户参与**: 一线商务的反馈和建议至关重要
- ✅ **数据基础**: 高质量的数据是系统价值的基石
- ✅ **持续迭代**: 快速响应需求，持续优化改进
- ✅ **文化建设**: 培养数据驱动和系统化思维的团队文化

---

## 🚀 快速启动

### 前置要求
- Python 3.10+
- Node.js 18+
- npm 或 yarn

### 方式一: 开发模式

#### 1. 启动后端

```bash
cd backend
pip install -r requirements.txt
python main.py
```

后端将运行在 `http://localhost:8000`

#### 2. 启动前端

```bash
cd frontend
npm install
npm run dev
```

前端将运行在 `http://localhost:5173`

#### 3. Demo账号登录

系统提供8个Demo账号，可以直接使用工号登录：

| 工号 | 姓名 | 角色 | 说明 |
|------|------|------|------|
| U001 | 刘总 | 分管负责人 | 可查看所有团队数据 |
| U002 | 王部长 | 部门负责人 | 可查看所有团队数据 |
| U003 | 张组长 | 组长 | 资金商务一组 |
| U004 | 李商务 | 商务 | 资金商务一组 |
| U005 | 赵商务 | 商务 | 资金商务一组 |
| U006 | 陈组长 | 组长 | 资金商务二组 |
| U007 | 孙商务 | 商务 | 资金商务二组 |
| U008 | 周商务 | 商务 | 资金商务二组 |

---

## 💡 核心功能

### 1. 战前准备 (Intelligence)

**功能模块**:
- 📊 **资方内参报告**: 输入资方名称，3秒生成完整档案
  - 业务数据：在贷余额、放款规模、排期情况
  - 运营数据：通过率、审批时长、M3+逾期率
  - 商务条件：资金成本、保证金比例、合作模式
  - 谈判建议：3套方案推荐（阶梯式/替代方案/折中方案）

- 💬 **话术知识库**: 按场景分类的标准话术
  - 资金成本谈判
  - 保证金条款谈判
  - 风险质疑应对
  - 合规施压应对
  - 业务量承诺
  - 新机构破冰

**使用场景**:
- 拜访前快速准备资方背景
- 领导参会前同步完整档案
- 查询特定场景的标准话术

---

### 2. 战中辅助 (Live Copilot)

**功能模块**:
- 🎙️ **实时对话记录**: 记录双方发言，形成时间轴
- 🤖 **0.5秒话术推荐**: 对方发言后，系统自动推荐应对话术
- 📝 **关键决策点标记**: 自动识别重要承诺和条件变化
- 🎤 **语音转文字**: 支持录音并实时转写（Demo版模拟）

**使用场景**:
- 正式谈判现场实时辅助
- 电话沟通时的话术支持
- 复杂场景的应对建议

---

### 3. 战后复盘 (Workflow)

**功能模块**:
- 📋 **谈判记录管理**: 所有拜访/谈判记录的统一管理
- 📊 **复盘报告生成**: 自动生成会议纪要和关键决策点
- ✅ **待办事项追踪**: 谈判后的跟进事项管理
- 👥 **参会人员登记**: 记录资方人员和我方人员信息

**使用场景**:
- 谈判结束后的记录沉淀
- 定期复盘和经验总结
- 待办事项的跟进管理

---

### 4. 团队看板 (Team Dashboard)

**功能模块**:
- 📈 **团队效能分析**: 谈判记录数、待办事项统计
- 👥 **成员业绩追踪**: 拜访次数、谈判成功率、成本优化
- 🏦 **资方覆盖情况**: 最后拜访时间、月均拜访频率、关系状态
- 📊 **场景分布分析**: 各类谈判场景的分布统计

**权限说明**:
- 商务：只能看到自己的记录
- 组长：可以看到本组所有成员的数据
- 部门负责人：可以切换查看不同团队的数据

---


## 📁 项目结构

```
negotiation_assistant_web/
├── frontend/                      # React前端
│   ├── src/
│   │   ├── pages/
│   │   │   ├── Login.jsx          # 登录页面
│   │   │   ├── Intelligence.jsx   # 战前准备
│   │   │   ├── LiveCopilot.jsx    # 战中辅助
│   │   │   ├── Workflow.jsx       # 战后复盘
│   │   │   └── Dashboard/
│   │   │       └── TeamDashboard.jsx  # 团队看板
│   │   ├── components/
│   │   │   ├── AppLayout.jsx      # 应用布局
│   │   │   └── PermissionGuard.jsx # 权限守卫
│   │   ├── context/
│   │   │   └── AuthContext.jsx    # 认证上下文
│   │   └── App.jsx                # 主应用
│   └── package.json
│
├── backend/                       # FastAPI后端
│   ├── main.py                    # 主入口
│   ├── models.py                  # 数据模型
│   ├── auth.py                    # 认证授权
│   ├── database.py                # 数据库(Demo数据)
│   ├── routes_auth.py             # 认证API
│   ├── routes_records.py          # 记录管理API
│   ├── routes_dashboard.py        # 看板API
│   ├── routes_intelligence.py     # 内参报告API
│   └── routes_playbook.py         # 话术匹配API
│
└── README.md
```

---

## 🔧 技术栈

### 前端技术
- **框架**: React 18
- **构建工具**: Vite
- **路由**: React Router v6
- **状态管理**: React Context API + Hooks
- **样式**: CSS Modules
- **HTTP**: Fetch API
- **认证**: JWT Token

### 后端技术
- **框架**: FastAPI
- **Python**: 3.10+
- **数据验证**: Pydantic
- **认证**: JWT (python-jose)
- **CORS**: fastapi.middleware.cors
- **数据存储**: 内存数据库(Demo版)

### 权限系统
- **角色层级**: 
  - EMPLOYEE (商务) < TEAM_LEADER (组长) < DIRECTOR (部门负责人)
- **数据隔离**: 
  - 商务只能看到自己的记录
  - 组长可以看到本组所有记录
  - 部门负责人可以看到本部门所有记录
- **JWT Token**: 包含 user_id, role, team_id, department_id

---


## 🔌 API文档

### 1. 认证相关

#### 登录
```http
POST /api/auth/login
Content-Type: application/json

{
  "user_id": "U001"
}
```

**响应**:
```json
{
  "success": true,
  "user": {
    "user_id": "U001",
    "name": "刘总",
    "role": "director",
    "team_id": "dept_001",
    "department_id": "dept_001"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "message": "登录成功"
}
```

#### 获取当前用户信息
```http
GET /api/auth/me
Authorization: Bearer {token}
```

---

### 2. 资方内参报告

```http
POST /api/intelligence/generate
Content-Type: application/json

{
  "funder_name": "中关村银行"
}
```

**响应**:
```json
{
  "fund_name": "中关村银行",
  "fund_type": "银行",
  "outstanding_balance": 8750,
  "last_month_loan": 1200,
  "current_month_plan": 1500,
  "approval_rate": 62.3,
  "m3_overdue_rate": 4.8,
  "avg_approval_days": 2.8,
  "funding_cost": 7.5,
  "deposit_rate": 6,
  "cooperation_mode": "助贷模式"
}
```

---

### 3. 话术匹配

```http
POST /api/playbook/match
Content-Type: application/json

{
  "user_input": "保证金必须提到10%"
}
```

**响应**:
```json
{
  "success": true,
  "data": [
    {
      "id": "script_001",
      "scene": "保证金条款谈判",
      "name": "阶梯式保证金方案",
      "content": "理解评审委员会立场...",
      "tips": "不直接拒绝，提出阶梯方案"
    }
  ]
}
```

---

### 4. 团队看板

```http
GET /api/dashboard/team/{team_id}
Authorization: Bearer {token}
```

**响应**:
```json
{
  "overview": {
    "totalRecords": 15,
    "totalTodos": 45,
    "completedTodos": 30,
    "pendingTodos": 15,
    "totalVisits": 12,
    "totalNegotiations": 8,
    "successRate": 75.0,
    "avgCostReduction": 0.35
  },
  "member_performance": [...],
  "funder_coverage": [...],
  "scene_distribution": {...},
  "monthly_trend": [...]
}
```

---

## 🐛 已知问题

1. ⚠️ 当前使用内存数据库，重启后数据丢失
2. ⚠️ 需要接入真实Dataphin数据源
3. ⚠️ 话术匹配算法需要进一步优化
4. ⚠️ 语音转写功能为Demo模拟，需要接入真实ASR服务

---

## 📝 更新日志

### 2026-02-11
- ✅ 完成用户认证和权限管理系统
  - JWT Token认证
  - 三级角色权限（商务/组长/部门负责人）
  - 数据隔离和权限守卫
- ✅ 完成团队看板功能
  - 团队效能分析
  - 成员业绩追踪
  - 资方覆盖情况
  - 场景分布统计
- ✅ 完成战后复盘功能
  - 谈判记录管理
  - 待办事项追踪
  - 参会人员登记
- ✅ 更新UI文案
  - 战前准备：资方基本信息、相关测算、谈判策略
  - 战中辅助：实时谈判辅助
- ✅ 完善README文档
  - 添加项目背景与痛点
  - 添加目标价值说明
  - 完善技术文档

### 2026-02-10
- ✅ 完成所有三个核心页面
  - Intelligence.jsx (战前准备)
  - LiveCopilot.jsx (战中辅助)
  - Workflow.jsx (战后复盘)
- ✅ 实现统一导航系统
- ✅ 完整样式系统
- ✅ 前端工程配置

---

## 🤝 贡献指南

1. Fork项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交代码 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 发起Pull Request

---

## 📞 联系方式

- **项目负责人**: 资金商务团队
- **技术支持**: 提Issue或联系开发团队

---

**最后更新**: 2026-02-11  
**版本**: v0.2.0 (权限管理版)
